<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>아수라장 랭킹</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

    {% if error %}
    <div style="text-align:center;">
        <img src="/static/error_image.png" alt="에러 이미지" width="200" />
        <p style="font-size: 18px; margin-top: 10px;">주인장이 게임을 꺼서 못봐요</p>
    </div>
    {% else %}

    <h1>Top 100 랭커</h1>
    <table>
        <thead>
            <tr>
                <th>순위</th>
                <th>닉네임</th>
                <th>캐릭터</th>
                <th>RP</th>
            </tr>
        </thead>
        <tbody>
            {% for p in players %}
            <tr>
                <td>{{ p.rank }}</td>
                <td>{{ p.nickname }}</td>
                <td>{{ p.champion }}</td>
                <td>{{ p.score }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <h2>자주 사용된 캐릭터</h2>
    <canvas id="chart" width="400" height="300"></canvas>

    <script>
        const ctx = document.getElementById('chart');
        const chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: {{ champion_stats.labels | safe }},
                datasets: [{
                    label: '사용 횟수',
                    data: {{ champion_stats.counts | safe }},
                    backgroundColor: 'rgba(75, 192, 192, 0.4)'
                }]
            },
            options: {
                indexAxis: 'y',
                scales: {
                    x: { beginAtZero: true }
                }
            }
        });
    </script>
{% endif %}
</body>
</html>